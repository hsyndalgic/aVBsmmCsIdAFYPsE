"0","#Replacing outliers with NA s"
"0","df_all<-df"
"0","outlierreplacement <- function(dataframe){"
"0","   dataframe %>%          "
"0","           map_if(is.numeric, ~ replace(.x, .x %in% boxplot.stats(.x)$out, NA)) %>%"
"0","           bind_cols "
"0","}"
"0",""
"0",""
"0","df_all<-outlierreplacement(df_all) "
"0",""
"0","df_all <- data.frame(df_all, rnorm(nrow(df_all)))"
"0",""
"0","summary(df_all)"
"1",""
"1","      age       "
"1","          job      "
"1","     marital     "
"1","     education    "
"1"," default    "
"1","    balance       "
"1","
"
"1"," Min.   :19.00  "
"1"," blue-collar:9446  "
"1"," divorced: 4725  "
"1"," primary  : 6694  "
"1"," no :39191  "
"1"," Min.   :-1818.0  "
"1","
"
"1"," 1st Qu.:33.00  "
"1"," management :8167  "
"1"," married :24386  "
"1"," secondary:21782  "
"1"," yes:  809  "
"1"," 1st Qu.:   30.0  "
"1","
"
"1"," Median :39.00  "
"1"," technician :6848  "
"1"," single  :10889  "
"1"," tertiary :11514  "
"1","            "
"1"," Median :  313.0  "
"1","
"
"1"," Mean   :40.47  "
"1"," admin      :4560  "
"1","                 "
"1"," NA's     :   10  "
"1","            "
"1"," Mean   :  576.1  "
"1","
"
"1"," 3rd Qu.:48.00  "
"1"," services   :3910  "
"1","                 "
"1","                  "
"1","            "
"1"," 3rd Qu.:  887.0  "
"1","
"
"1"," Max.   :70.00  "
"1"," (Other)    :7059  "
"1","                 "
"1","                  "
"1","            "
"1"," Max.   : 3216.0  "
"1","
"
"1"," NA's   :79     "
"1"," NA's       :  10  "
"1","                 "
"1","                  "
"1","            "
"1"," NA's   :4280     "
"1","
"
"1",""
"1"," housing    "
"1","  loan      "
"1","      contact     "
"1","      day       "
"1","     month      "
"1","    duration    "
"1","    campaign    "
"1","
"
"1"," no :15969  "
"1"," no :33070  "
"1"," cellular :37345  "
"1"," Min.   : 1.00  "
"1"," may    :13532  "
"1"," Min.   :  0.0  "
"1"," Min.   :1.000  "
"1","
"
"1"," yes:24031  "
"1"," yes: 6930  "
"1"," telephone: 2645  "
"1"," 1st Qu.: 8.00  "
"1"," jul    : 6380  "
"1"," 1st Qu.: 94.0  "
"1"," 1st Qu.:1.000  "
"1","
"
"1","            "
"1","            "
"1"," NA's     :   10  "
"1"," Median :17.00  "
"1"," aug    : 5215  "
"1"," Median :162.0  "
"1"," Median :2.000  "
"1","
"
"1","            "
"1","            "
"1","                  "
"1"," Mean   :16.02  "
"1"," jun    : 4734  "
"1"," Mean   :197.9  "
"1"," Mean   :2.181  "
"1","
"
"1","            "
"1","            "
"1","                  "
"1"," 3rd Qu.:21.00  "
"1"," nov    : 3598  "
"1"," 3rd Qu.:269.0  "
"1"," 3rd Qu.:3.000  "
"1","
"
"1","            "
"1","            "
"1","                  "
"1"," Max.   :31.00  "
"1"," apr    : 2718  "
"1"," Max.   :632.0  "
"1"," Max.   :6.000  "
"1","
"
"1","            "
"1","            "
"1","                  "
"1","                "
"1"," (Other): 3823  "
"1"," NA's   :3000   "
"1"," NA's   :2992   "
"1","
"
"1",""
"1","   y        "
"1"," rnorm.nrow.df_all.."
"1","
"
"1"," no :37104  "
"1"," Min.   :-4.129135  "
"1","
"
"1"," yes: 2896  "
"1"," 1st Qu.:-0.678608  "
"1","
"
"1","            "
"1"," Median :-0.009618  "
"1","
"
"1","            "
"1"," Mean   :-0.005762  "
"1","
"
"1","            "
"1"," 3rd Qu.: 0.674123  "
"1","
"
"1","            "
"1"," Max.   : 4.322815  "
"1","
"
"1","            "
"1","                    "
"1","
"
"0","#reach out variables which has outliers"
"0",""
"0","miss_vars<-dataset[,names(df_all[, colSums(is.na(df_all))!=0])]"
"0",""
"0","#detect NA values randomly"
"0","age_miss_index <-sample (which(!is.na(df_all$age)), size=10, replace =F)"
"0","balance_miss_index <-sample (which(!is.na(df_all$balance)), size=10, replace =F)"
"0","duration_miss_index <-sample (which(!is.na(df_all$duration)), size=10, replace =F)"
"0","campaign_miss_index <-sample (which(!is.na(df_all$campaign)), size=10, replace =F)"
"0",""
"0","df_all[age_miss_index, ""age""] <- NA "
"0","df_all[balance_miss_index, ""balance""] <- NA"
"0","df_all[duration_miss_index, ""duration""] <- NA"
"0","df_all[campaign_miss_index, ""campaign""] <- NA"
"0",""
"0",""
"0","l <- list(age=age_miss_index,balance=balance_miss_index,duration=duration_miss_index,campaign=campaign_miss_index)"
"0",""
"0",""
"0",""
"0","#to reach out observations in main dataset"
"0","df[c(l$age),]$age"
"1"," [1]"
"1"," 25"
"1"," 54"
"1"," 37"
"1"," 37"
"1"," 32"
"1"," 57"
"1"," 25"
"1"," 57"
"1"," 53"
"1"," 57"
"1","
"
"0","df[c(l$balance),]$balance"
"1"," [1]"
"1","  103"
"1","  576"
"1","  266"
"1","    0"
"1"," 2144"
"1"," 2347"
"1"," -187"
"1"," -119"
"1","  606"
"1","  424"
"1","
"
"0","df[c(l$duration),]$duration"
"1"," [1]"
"1","  92"
"1"," 156"
"1"," 184"
"1"," 155"
"1"," 168"
"1","  94"
"1"," 176"
"1"," 177"
"1"," 118"
"1"," 207"
"1","
"
"0","df[c(l$campaign),]$campaign"
"1"," [1]"
"1"," 1"
"1"," 5"
"1"," 1"
"1"," 2"
"1"," 1"
"1"," 1"
"1"," 2"
"1"," 1"
"1"," 2"
"1"," 1"
"1","
"
"0","rf_data <- missForest(df_all)"
"1","  missForest iteration"
"1"," "
"1","1"
"1"," "
"1","in progress..."
